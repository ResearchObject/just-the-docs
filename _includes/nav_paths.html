{%- comment -%}
  {% include nav_paths.html nodes=unsorted_array ancestors=array path=string2 %}
  - assigns nav_page_ancestors
  - assigns nav_page_path
  - assigns nav_page_child_nodes
  - deletes nav_paths_*
{%- endcomment -%}

{%- include nav_sort.html nodes=include.nodes -%}
{%- for node in nav_sort_nodes -%}
  {%- assign nav_paths_child_nodes = nav_parenthood | where: "name", node.title
        | map: "items" | first -%}
  {%- assign nav_paths_child_grandparent_titles = nav_paths_child_nodes | map: "grand_parent" -%}
  {%- assign nav_paths_child_ancestor_titles = nav_paths_child_nodes | map: "ancestor" -%}
  {%- assign nav_paths_titles = nav_paths_child_grandparent_titles
        | concat: nav_paths_child_ancestor_titles | uniq -%}
  {%- if nav_paths_titles.size >= 2 -%}
    {%- assign nav_paths_grandchild_nodes = nav_paths_child_nodes | where: "grand_parent", node.parent -%}
    {%- assign nav_paths_ancestors_titles = include.ancestors | map: "title" -%}
    {%- assign nav_paths_descendant_nodes = nav_paths_child_nodes
          | where_exp: "item", "nav_paths_ancestors_titles contains item.ancestor" -%}
    {%- assign nav_paths_child_nodes = nav_paths_grandchild_nodes
          | concat: nav_paths_descendant_nodes -%}
  {%- endif -%}
  {%- assign nav_paths_path =  include.path | append: " " | append: forloop.index -%}
  {%- if node.url == page.url -%}
    {%- assign nav_page_ancestors = include.ancestors -%}
    {%- assign nav_page_path = nav_paths_path -%}
    {%- assign nav_page_child_nodes = nav_paths_child_nodes -%}
  {%- endif -%}
  {%- if nav_paths_child_nodes.size >= 1 -%}
    {%- assign nav_paths_ancestors =  include.ancestors | push: node -%}
    {%- include nav_paths.html nodes=nav_paths_child_nodes ancestors=nav_paths_ancestors path=nav_paths_path -%}
  {%- endif -%}
{%- endfor -%}

{%- assign nav_paths_child_nodes = nil -%}
{%- assign nav_paths_parent_titles = nil -%}
{%- assign nav_paths_child_ancestor_titles = nil -%}
{%- assign nav_paths_ancestors_titles = nil -%}
{%- assign nav_paths_ancestors = nil -%}
{%- assign nav_paths_path = nil -%}
